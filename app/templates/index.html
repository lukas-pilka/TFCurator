{% extends "base.html" %}
{% block content %}

<div class="container">

    <section class="mainSection titleScreen">
        <div class="titlePart">
            <h1>Image of the {{ searchedObject }}</h1>
            <p class="subtitle flexItem">Generated exhibition based on big cultural data</p>
        </div>
        <div class="footerPart">
            <p class="footnote flexItem">Lukáš Pilka, 2020</p>
        </div>
    </section>

    <section class="mainSection galleryIntro">
        <div class="introPart introTitle ">
            <h2>{{ searchedObject }}, Data & History</h2>
            <p class="subtitle">How the proportion of images with the {{ searchedObject }} has changed over the history</p>
        </div>
        <div class="introPart chart">
            <canvas id="line-chart" width="800" height="450"></canvas>
        </div>
        <article class="introPart detailInformation">
            <p>In 2015, Lev Manovich described Digital Art History as a set of methodologies using quantitative analysis to explore cultural artifacts. DAH represents a new approach to looking at history through mathematical and statistical ways with using cultural databases, digitized museum and archive collections, metadata, texts on art, and virtual reproductions of artworks. One of the methodologies in Digital Art History is visual analyzes based on current technologies of artificial intelligence and machine image recognition. Similar tools such as those used to navigate self-driving cars, identify people in photos, or classify medical images can also be used to look at historical paintings, graphics or drawings.</p>
            <p>Art historian is a person who can only remember hundreds of works of art in his or her memory, which he or she is able to recall and work with them. But are these the most important works? Are there other works that are much more relevant to the topic and whose finding can completely change meaning and message? Thanks to neural networks, it is possible to explore image databases of hundreds of thousands or millions of items, navigate them in large cultural data, and look at the history from a new perspective. How will our notion of a certain era change if it is based not only on a few canonical works but on all digitized works?</p>
        </article>
    </section>

    <section class="mainSection galleryShowcase">
        {% for artwork in artworksForWeb %}
        <article class="artwork">
            <div class="imageContainer">
                <img src="{{ artwork._source.image_url }}">
                <div class="boundBoxes">
                    {% for object in artwork['_source']['detected_objects'] %}
                    <div class="boundBox"
                         style="left:{{ object.boundBox[1]*100 }}%; top: {{ object.boundBox[0]*100 }}%; width:{{ object.boundBox[3]*100 - object.boundBox[1]*100}}%; height: {{ object.boundBox[2]*100 - object.boundBox[0]*100}}%;">
                        <p>{{ object['object'] }}&nbsp;{{ 100*object['score']}}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="artworkDescription">
                <p class="museumInfo">
                    {{ artwork._source.title }} <br>
                    {{ artwork._source.author[0] }}<br>
                    {{ artwork._source.date_earliest }}<br>
                    {{ artwork._source.gallery }}<br>
                </p>
                <p class="generatedInfo">
                    {{ searchedObject }}:&nbsp;{{ 100*artwork._source.top_object_score }}%
                </p>
            </div>
        </article>
        {% endfor %}
    </section>

    <div class="mainSection finalScreen">
        <div class="titlePart">
            <h1>Goodbye</h1>
        </div>
        <div class="footerPart">
            <p class="footnote flexItem">
                {% for collection in collectionsSum %}
                {{collection.key}}: {{collection.doc_count}}&nbsp;artworks<br>
                {% endfor %}
            </p>
        </div>
    </div>

</div>

<script>
    // Global parameters for all charts:
    Chart.defaults.global.responsive = false;
    Chart.defaults.global.defaultFontColor = '#111111';
    Chart.defaults.global.defaultFontSize = 16;
    Chart.defaults.global.defaultFontFamily = "'Montserrat', sans-serif";
    Chart.defaults.global.tooltips.backgroundColor = "#111111";
    Chart.defaults.global.tooltips.titleFontSize = 16;
    Chart.defaults.global.tooltips.bodyFontSize = 16;
    Chart.defaults.global.tooltips.cornerRadius = 0;
    Chart.defaults.global.tooltips.xPadding = 20;
    Chart.defaults.global.tooltips.yPadding = 20;
    Chart.defaults.global.tooltips.borderColor = '#111111';
    Chart.defaults.global.tooltips.borderWidth = 1;
    Chart.defaults.global.tooltips.displayColors = false;
    Chart.defaults.scale.gridLines.display = false;
    Chart.defaults.scale.ticks.beginAtZero = true;

    // Bar chart
    new Chart(document.getElementById("line-chart"), {
        type: 'line',
        data: {
            labels: {{artworksInPeriod[0]}},
            datasets: [
                {
                    backgroundColor: "rgba(255, 255, 255, 0)",
                    pointBackgroundColor: "#111111",
                    borderColor: "#111111",
                    pointRadius: 4,
                    pointHoverRadius: 6,
                    data: {{artworksInPeriod[1]}}
                }
            ]
        },
        options: {
            legend: {display: false},
            title: {display: false},
            tooltips: {
                callbacks: {
                    label: (tooltipItems, data) => {
                        return data.datasets[tooltipItems.datasetIndex].data[tooltipItems.index] + ' %';
                    }
                },
            },
            scales: {
                yAxes: [{
                    ticks: {
                        callback: function(value, index, values) {
                            return value + ' %';
                        }
                    }
                }]
            }
        },
    });
</script>

{% endblock %}