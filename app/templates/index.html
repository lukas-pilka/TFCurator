{% extends "base.html" %}
{% block content %}

<div class="container">

    <div class="titleScreen">
        <div class="titlePart">
            <h1>Image of the {{ searchedObject }}</h1>
            <h2 class="subtitle flexItem">Generated exhibition based on big cultural data</h2>
        </div>
        <div class="footerPart">
            <p class="footnote flexItem">Lukáš Pilka, 2020</p>
        </div>
    </div>

    <div style="width: 1000px;">
        <canvas id="line-chart" width="800" height="450"></canvas>
    </div>

    <div class="gallerySection">
        {% for artwork in artworksForWeb %}
        <article class="artwork">
            <div class="imageContainer">
                <img src="{{ artwork._source.image_url }}">
                <div class="boundBoxes">
                    {% for object in artwork['_source']['detected_objects'] %}
                    <div class="boundBox"
                         style="left:{{ object.boundBox[1]*100 }}%; top: {{ object.boundBox[0]*100 }}%; width:{{ object.boundBox[3]*100 - object.boundBox[1]*100}}%; height: {{ object.boundBox[2]*100 - object.boundBox[0]*100}}%;">
                        <p>{{ object['object'] }}&nbsp;{{ 100*object['score']}}</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="artworkDescription">
                <p class="museumInfo">
                    {{ artwork._source.title }} <br>
                    {{ artwork._source.author[0] }}<br>
                    {{ artwork._source.date_earliest }}<br>
                    {{ artwork._source.gallery }}<br>
                </p>
                <p class="generatedInfo">
                    {{ searchedObject }}:&nbsp;{{ 100*artwork._source.top_object_score }}%
                </p>
            </div>
        </article>
        {% endfor %}
    </div>

    <div class="finalScreen">
        <div class="titlePart">
            <h1>Goodbye</h1>
        </div>
        <div class="footerPart">
            <p class="footnote flexItem">
                {% for collection in collectionsSum %}
                {{collection.key}}: {{collection.doc_count}}&nbsp;artworks<br>
                {% endfor %}
            </p>
        </div>
    </div>

</div>

<script>
    // Global parameters for all charts:
    Chart.defaults.global.responsive = false;
    Chart.defaults.global.defaultFontColor = '#111111';
    Chart.defaults.global.defaultFontSize = 16;
    Chart.defaults.global.defaultFontFamily = "'Montserrat', sans-serif";
    Chart.defaults.global.tooltips.backgroundColor = "#111111";
    Chart.defaults.global.tooltips.titleFontSize = 16;
    Chart.defaults.global.tooltips.bodyFontSize = 16;
    Chart.defaults.global.tooltips.cornerRadius = 0;
    Chart.defaults.global.tooltips.xPadding = 20;
    Chart.defaults.global.tooltips.yPadding = 20;
    Chart.defaults.global.tooltips.borderColor = '#111111';
    Chart.defaults.global.tooltips.borderWidth = 1;
    Chart.defaults.global.tooltips.displayColors = false;
    Chart.defaults.scale.gridLines.display = false;
    Chart.defaults.scale.ticks.beginAtZero = true;

    // Bar chart
    new Chart(document.getElementById("line-chart"), {
        type: 'line',
        data: {
            labels: {{artworksInPeriod[0]}},
            datasets: [
                {
                    backgroundColor: "rgba(255, 255, 255, 0)",
                    pointBackgroundColor: "#111111",
                    borderColor: "#111111",
                    pointRadius: 4,
                    pointHoverRadius: 6,
                    data: {{artworksInPeriod[1]}}
                }
            ]
        },
        options: {
            legend: {display: false},
            title: {display: false},
            tooltips: {
                callbacks: {
                    label: (tooltipItems, data) => {
                        return data.datasets[tooltipItems.datasetIndex].data[tooltipItems.index] + ' %';
                    }
                },
            },
            scales: {
                yAxes: [{
                    ticks: {
                        callback: function(value, index, values) {
                            return value + ' %';
                        }
                    }
                }]
            }
        },
    });
</script>

{% endblock %}